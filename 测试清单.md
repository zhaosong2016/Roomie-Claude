# Space One 拼房实验室 - 完整测试清单

## 测试环境准备
- [ ] 微信开发者工具已打开项目
- [ ] 后端 API 已启动（服务器上运行）
- [ ] 测试用的活动口令：ASBJ0328
- [ ] 准备至少2个测试账号（Test1, Test2）

---

## 一、首页测试

### 1.1 页面加载
- [ ] 首页正常显示 logo 背景
- [ ] 显示"Space One 拼房实验室"标题
- [ ] 显示累计用户数（从后端获取）
- [ ] "我要拼房"按钮可见

### 1.2 输入口令
- [ ] 点击"我要拼房"，显示输入框
- [ ] 输入框提示"请输入口令"
- [ ] 输入小写字母自动转大写
- [ ] 底部显示"不知道活动口令？请联系活动组织者"
- [ ] 底部显示"如果你是活动组织者，点击这里创建活动口令"

### 1.3 口令验证
- [ ] 输入空口令，提示"请输入口令"
- [ ] 输入正确口令（ASBJ0328），显示"口令验证成功"和统计信息
- [ ] 3秒后自动跳转到表单页
- [ ] 输入错误口令，显示"此口令下暂无其他用户"弹窗
- [ ] 弹窗可以选择"仍然继续"或"重新输入"

### 1.4 网络异常
- [ ] 断网状态下验证口令，显示"网络连接失败，请重试"
- [ ] 防抖测试：快速连续点击"进入拼房"，只触发一次

---

## 二、表单页测试

### 2.1 页面显示
- [ ] 页面标题"填写信息进入拼房池"
- [ ] 所有输入框正常显示
- [ ] 日期选择器可以打开
- [ ] 单选框可以选择

### 2.2 基础信息填写
- [ ] 姓名输入框：可以输入中文、英文
- [ ] 微信号输入框：可以输入字母、数字
- [ ] 性别选择：女/男 单选
- [ ] 入住日期：可以选择今天及以后的日期
- [ ] 退房日期：可以选择今天及以后的日期
- [ ] 吸烟习惯：否/是 单选

### 2.3 睡眠习惯填写
- [ ] 作息倾向：早睡鸟/夜猫子 单选
- [ ] 抗噪等级：神经衰弱/普通玩家/雷打不动 单选
- [ ] 出声分贝：寂静模式/混响模式/低音炮模式 单选

### 2.4 协议勾选
- [ ] 显示"我已阅读并同意《用户协议》"复选框
- [ ] 显示"我已阅读并同意《隐私政策》"复选框
- [ ] 点击"《用户协议》"跳转到协议页面
- [ ] 点击"《隐私政策》"跳转到隐私政策页面
- [ ] 未勾选协议时，提交按钮禁用（灰色）
- [ ] 勾选两个协议后，提交按钮可用（蓝色）

### 2.5 表单验证
- [ ] 姓名为空，提示"请输入姓名"
- [ ] 微信号为空，提示"请输入微信号"
- [ ] 性别未选，提示"请选择性别"
- [ ] 入住日期未选，提示"请选择入住日期"
- [ ] 退房日期未选，提示"请选择退房日期"
- [ ] 退房日期早于或等于入住日期，提示"退房日期必须晚于入住日期"
- [ ] 吸烟习惯未选，提示"请选择是否吸烟"
- [ ] 作息习惯未选，提示"请选择作息习惯"
- [ ] 噪音容忍度未选，提示"请选择噪音容忍度"
- [ ] 噪音输出未选，提示"请选择噪音输出"
- [ ] 协议未勾选，提示"请阅读并同意用户协议和隐私政策"

### 2.6 提交成功
- [ ] 所有信息填写完整，点击"确认进入拼房池"
- [ ] 显示"提交中..."加载提示
- [ ] 提交成功后跳转到结果页

### 2.7 网络异常
- [ ] 断网状态下提交，显示"网络连接失败，请检查网络后重试"
- [ ] 超时（10秒）后显示错误提示

---

## 三、协议页面测试

### 3.1 用户协议
- [ ] 从表单页点击《用户协议》跳转
- [ ] 页面标题显示"协议详情"
- [ ] 显示黄色警告框，包含4条重要提示
- [ ] 显示完整协议内容（8个章节）
- [ ] 可以滚动查看所有内容
- [ ] 底部显示"生效日期：2026年3月5日"
- [ ] 显示联系邮箱：spaceone.roomie@gmail.com
- [ ] 可以返回表单页

### 3.2 隐私政策
- [ ] 从表单页点击《隐私政策》跳转
- [ ] 页面标题显示"协议详情"
- [ ] 显示黄色警告框，包含5条重要提示
- [ ] 显示完整隐私政策内容（7个章节）
- [ ] 可以滚动查看所有内容
- [ ] 底部显示生效日期和更新日期
- [ ] 显示联系邮箱
- [ ] 可以返回表单页

---

## 四、结果页测试

### 4.1 匹配成功（完全匹配）
**测试步骤**：
1. Test1 填写表单（日期：3月1日-3月3日）
2. Test2 填写表单（日期：3月1日-3月3日，其他信息与 Test1 匹配）

**验证**：
- [ ] 显示"🎉 有一位潜在室友，快联系TA吧"
- [ ] **不显示**黄色日期警告框（因为日期完全匹配）
- [ ] 显示对方姓名
- [ ] 显示对方微信号
- [ ] 显示对方入住日期
- [ ] 显示对方吸烟习惯
- [ ] 显示对方作息倾向
- [ ] 显示对方噪音容忍度
- [ ] 显示对方睡眠声响
- [ ] 显示"复制微信号"按钮

### 4.2 匹配成功（部分匹配）
**测试步骤**：
1. Test1 已在池中（日期：3月1日-3月3日）
2. Test3 第二次提交（日期：3月2日-3月5日，与 Test1 有重叠）

**验证**：
- [ ] 显示"🎉 有一位潜在室友，快联系TA吧"
- [ ] **显示黄色警告框**："⚠️ 注意：你们的入住日期不完全相同，仅有部分重叠。建议联系对方确认具体日期。"
- [ ] 显示对方完整信息
- [ ] 显示"复制微信号"按钮

### 4.3 等待匹配
**测试步骤**：
1. Test4 填写表单，但池中无匹配对象

**验证**：
- [ ] 显示"⏳ 等待匹配中"
- [ ] 显示"已加入匹配池，等待其他用户加入"
- [ ] 显示"匹配成功后我们会通知您"
- [ ] 显示"返回首页"按钮

### 4.4 重复提交（已匹配）
**测试步骤**：
1. Test1 和 Test2 已匹配
2. Test1 重新输入口令并提交

**验证**：
- [ ] 显示"✅ 你已匹配过这位室友"
- [ ] 显示对方信息
- [ ] 显示两个按钮："去加微信"和"重新匹配"

### 4.5 复制微信号
- [ ] 点击"复制微信号"按钮
- [ ] 显示"微信号已复制"提示
- [ ] 可以粘贴到其他地方验证

### 4.6 解除匹配
**测试步骤**：
1. Test1 和 Test2 已匹配
2. Test1 点击"重新匹配"

**验证**：
- [ ] 显示确认弹窗："确认重新匹配"
- [ ] 弹窗内容："解除当前匹配后，对方也会被解绑。确定继续吗？"
- [ ] 点击"取消"，留在当前页面
- [ ] 点击"确定"，显示"解除中..."
- [ ] 解除成功，显示"已解除匹配"
- [ ] 10秒后自动跳转到首页

### 4.7 解除匹配后验证
**测试步骤**：
1. Test1 和 Test2 解绑后
2. 分别查看数据库

**验证**：
- [ ] Test1 状态变为 active
- [ ] Test2 状态变为 active
- [ ] Test1 的 history 包含 Test2 的 ID
- [ ] Test2 的 history 包含 Test1 的 ID

### 4.8 历史记忆功能
**测试步骤**：
1. Test1 和 Test2 解绑后
2. Test1 重新提交表单

**验证**：
- [ ] Test1 不会再匹配到 Test2
- [ ] 如果池中有 Test3，会匹配到 Test3
- [ ] 如果池中只有 Test2，显示"等待匹配"

### 4.9 网络异常
- [ ] 解绑时断网，显示"网络连接失败，请重试"

---

## 五、数据一致性测试

### 5.1 重复提交
**测试步骤**：
1. Test1 提交表单
2. Test1 重新输入口令，修改信息后再次提交

**验证**：
- [ ] 数据库中只有一条 Test1 的记录
- [ ] 记录的 submit_count 增加
- [ ] 信息已更新为最新提交的内容

### 5.2 匹配状态同步
**测试步骤**：
1. Test1 和 Test2 匹配成功

**验证**：
- [ ] 数据库中 Test1 状态为 matched
- [ ] 数据库中 Test2 状态为 matched
- [ ] 两者的 pair_id 相同
- [ ] Test1 的 matched_partner 是 Test2
- [ ] Test2 的 matched_partner 是 Test1

### 5.3 解绑状态同步
**测试步骤**：
1. Test1 解除与 Test2 的匹配

**验证**：
- [ ] Test1 状态变为 active
- [ ] Test2 状态变为 active
- [ ] 两者的 pair_id 被清空
- [ ] matched_partner 被清空
- [ ] history 中记录了对方 ID

---

## 六、边界情况测试

### 6.1 日期边界
- [ ] 选择今天作为入住日期，可以提交
- [ ] 选择明天作为退房日期，可以提交
- [ ] 入住和退房是同一天，提示错误

### 6.2 特殊字符
- [ ] 姓名输入 emoji，可以提交
- [ ] 微信号输入特殊字符（-_），可以提交
- [ ] 口令输入小写字母，自动转大写

### 6.3 长文本
- [ ] 姓名输入很长的文本（50个字），可以提交
- [ ] 微信号输入很长的文本，可以提交

### 6.4 快速操作
- [ ] 快速连续点击提交按钮，只提交一次
- [ ] 快速连续点击"进入拼房"，只触发一次

---

## 七、性能测试

### 7.1 加载速度
- [ ] 首页加载时间 < 2秒
- [ ] 表单页加载时间 < 1秒
- [ ] 协议页加载时间 < 1秒
- [ ] 结果页加载时间 < 1秒

### 7.2 网络超时
- [ ] 所有请求超时时间设置为 10秒
- [ ] 超时后显示友好错误提示

---

## 八、真机测试（必须）

### 8.1 iOS 设备
- [ ] iPhone 上打开小程序
- [ ] 所有功能正常
- [ ] 页面显示正常
- [ ] 按钮可以点击

### 8.2 Android 设备
- [ ] Android 手机上打开小程序
- [ ] 所有功能正常
- [ ] 页面显示正常
- [ ] 按钮可以点击

### 8.3 不同网络环境
- [ ] WiFi 环境下测试
- [ ] 4G/5G 环境下测试
- [ ] 弱网环境下测试（可以用开发者工具模拟）

---

## 九、数据库检查

### 9.1 数据完整性
- [ ] 打开服务器，查看 room_data.json
- [ ] 验证所有用户数据格式正确
- [ ] 验证 matched 用户在前，active 用户在后（自动排序）
- [ ] 验证 history 字段正确记录

### 9.2 统计数据
- [ ] 首页显示的用户数与数据库一致
- [ ] 口令验证时显示的统计数据正确

---

## 十、上线前最终检查

- [ ] 所有测试项通过
- [ ] 真机测试通过
- [ ] 数据库数据正常
- [ ] 后端 API 稳定运行
- [ ] 协议内容无错别字
- [ ] 联系邮箱正确：spaceone.roomie@gmail.com
- [ ] 生效日期正确：2026年3月5日
- [ ] OpenID 登录已禁用（内测阶段）

---

## 测试记录

**测试日期**：________

**测试人员**：________

**测试环境**：
- 微信开发者工具版本：________
- 后端服务器：49.233.127.228:5000
- 测试口令：ASBJ0328

**发现的问题**：
1.
2.
3.

**测试结论**：
- [ ] 通过，可以上线
- [ ] 不通过，需要修复问题

---

**备注**：
- 测试时建议两个人配合，一个操作 Test1，一个操作 Test2
- 每个测试场景都要在真机上验证一遍
- 发现问题立即记录，不要遗漏
