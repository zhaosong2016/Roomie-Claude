# Roomie Claude 数据字典

## 用户字段定义

### 基础信息
- **name**: 用户姓名/昵称（字符串）
- **wechat_id**: 微信号（字符串）
- **openid**: 微信OpenID，用于识别用户（字符串，可选）
- **group_code**: 群口令，标识活动（字符串，大写）

### 性别 (gender)
| 值 | 含义 |
|---|---|
| `male` | 男 |
| `female` | 女 |

### 入住信息
- **check_in**: 入住日期（格式：YYYY-MM-DD）
- **check_out**: 退房日期（格式：YYYY-MM-DD）

### 吸烟习惯 (smoking)
| 值 | 含义 |
|---|---|
| `yes` | 吸烟 |
| `no` | 不吸烟 |

### 作息习惯 (schedule)
| 值 | 含义 | 描述 |
|---|---|---|
| `early_bird` | 早睡鸟 | 习惯早睡早起，生物钟稳定 |
| `night_owl` | 夜猫子 | 越晚越精神，深夜才是自由时间 |

### 噪音容忍度 (noise_in)
抗噪等级 - 对他人声音的容忍程度

| 值 | 含义 | 描述 |
|---|---|---|
| `weak` | 神经衰弱 | 有动静就醒 |
| `medium` | 普通玩家 | 正常翻身没问题 |
| `strong` | 雷打不动 | 倒头就睡，浑然不觉 |

### 睡眠声响 (noise_out)
出声分贝 - 自己睡觉时的声音大小

| 值 | 含义 | 描述 |
|---|---|---|
| `silent` | 寂静模式 | 非常安静，基本无声 |
| `loud` | 混响模式 | 偶尔翻身或磨牙 |
| `bass` | 低音炮模式 | 呼噜明显哈哈 |

### 状态字段
- **status**: 用户状态
  - `active`: 等待匹配中
  - `matched`: 已匹配成功
- **pair_id**: 匹配对ID（格式：PAIR_时间戳）
- **submit_count**: 提交次数（数字）
- **created_at**: 创建时间（Unix时间戳）
- **history**: 历史匹配记录（数组，存储曾匹配过的用户ID）
- **matched_partner**: 当前匹配对象信息
  - `name`: 对方姓名
  - `wechat_id`: 对方微信号

### 协议字段
- **user_agreement**: 是否同意微信联系授权（布尔值）
- **privacy_agreement**: 是否同意用户协议（布尔值）

## 匹配规则

### 完全匹配条件（第一次提交）
1. 性别相同 (gender)
2. 入住日期完全相同 (check_in, check_out)
3. 吸烟习惯相同 (smoking)
4. 噪音兼容性检查：
   - 如果一方是"神经衰弱"(weak)，对方必须是"寂静模式"(silent)
   - 如果一方是"低音炮模式"(bass)，对方不能是"神经衰弱"(weak)

### 部分匹配条件（第二次及以后提交）
1. 性别相同
2. 吸烟习惯相同
3. 噪音兼容性检查（同上）
4. 日期有重叠部分
5. 推荐重叠天数最多的用户

### 历史记忆规则
- 曾经匹配过的用户会被记录在 `history` 字段
- 再次匹配时会自动跳过 `history` 中的用户
- 即使解绑，也不会再次匹配到同一个人

---
创建时间：2026-02-19
最后更新：2026-02-19
