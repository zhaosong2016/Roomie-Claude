# Roomie Claude 项目记录

## 项目概述

**项目名称**：Space One拼房实验室（Roomie Claude）

**核心价值**：在睡眠质量不打折的前提下省钱，帮助参加同一活动的人匹配合适的室友

**目标用户**：参加会议、活动的人群

**关键时间节点**：2027年1月CES之前完成并投入使用

## 项目背景

- 产品经理：赵嵩（非技术背景）
- 之前与Gemini合作开发，遇到前后端value值不一致导致频繁报错
- 2026年2月16日开始与Claude重新开发，确保数据结构统一

## 当前进度（2026-02-17）

### 已完成
1. ✅ 创建新项目文件夹 `Roomie Claude`
2. ✅ 统一数据结构规范（详见 `数据结构说明.md`）
3. ✅ 完成Streamlit网页版基础功能
4. ✅ 实现核心匹配逻辑
5. ✅ 本地测试通过，数据存储正常
6. ✅ 确定完整商业模式和产品规划
7. ✅ 明确所有时间节点和里程碑

### 进行中
1. 🔄 微信小程序审核中（春节期间，预计2月24日后有结果）
2. 🔄 网页版CSS样式优化（按钮和单选框颜色）

### 待开始（紧急）
1. ⏰ 微信小程序前端开发（审核通过后立即开始）
2. ⏰ 后端API接口开发
3. ⏰ 服务器部署和配置

### 时间压力
- **距离3月5日只有16天**
- **春节假期影响**：小程序审核可能延迟到2月24日
- **实际开发时间**：可能只有9-10天
- **风险**：时间非常紧张，需要高效协作

## 技术架构

### 当前版本（网页版）
- **前端框架**：Streamlit
- **后端语言**：Python 3.14
- **数据存储**：JSON文件（room_data.json）
- **运行环境**：本地开发（http://localhost:8501）

### 未来版本
- **微信小程序**：前端用小程序语法，后端提供API接口
- **国际版**：考虑X或其他社交网络版本

## 数据结构（统一规范）

### 用户字段
| 字段名 | 类型 | 可选值 | 说明 |
|--------|------|--------|------|
| name | string | - | 用户名字/昵称 |
| wechat_id | string | - | 微信号 |
| gender | string | "女" / "男" | 性别 |
| check_in | string | YYYY-MM-DD | 入住日期 |
| check_out | string | YYYY-MM-DD | 退房日期 |
| smoking | string | "否" / "是" | 是否吸烟 |
| schedule | string | "early" / "late" | 作息倾向：早睡鸟/夜猫子 |
| noise_in | string | "weak" / "normal" / "strong" | 抗噪等级：神经衰弱/普通玩家/雷打不动 |
| noise_out | string | "silent" / "mix" / "bass" | 出声分贝：寂静模式/混响模式/低音炮模式 |
| group_code | string | - | 群专属口令 |
| status | string | "active" / "matched" | 状态：等待中/已匹配 |
| created_at | number | timestamp | 创建时间戳 |

### 匹配逻辑

**基础锁（必须完全相同）**：
- group_code：群口令
- gender：性别
- check_in：入住日期
- check_out：退房日期
- smoking：吸烟习惯
- schedule：作息倾向

**睡眠锁（兼容性检查）**：
1. 如果用户A的 `noise_in == "weak"`（神经衰弱），则用户B的 `noise_out` 必须 == `"silent"`（寂静模式）
2. 如果用户B的 `noise_in == "weak"`，则用户A的 `noise_out` 必须 == `"silent"`
3. 如果用户A的 `noise_out == "bass"`（低音炮），则用户B的 `noise_in` 必须 == `"strong"`（雷打不动）
4. 如果用户B的 `noise_out == "bass"`，则用户A的 `noise_in` 必须 == `"strong"`

## 产品规划路线图（已确定时间节点）

### 里程碑1：2026年3月5日（16天后）
**目标**：小程序基础版上线
**必须功能**：
- [x] 完成网页版原型（已完成）
- [ ] 微信小程序前端开发
- [ ] 后端API接口开发
- [ ] 群口令验证
- [ ] 信息表单收集
- [ ] 自动匹配算法
- [ ] 显示对方微信
- [ ] 显示统计数据（总匹配数、当前池子人数）

**不包含**：打赏功能、B端后台、导出功能

**开发时间表**：
- Week 1（2月17-23日）：搭建环境、开发前后端、本地测试
- Week 2（2月24-3月2日）：联调、优化、提交微信审核
- Week 3（3月3-5日）：审核通过、最后调整、正式交付

### 里程碑2：2026年3月28日（39天后）
**目标**：千人会议实战测试
**场景**：与主办方合作的千人规模会议
**准备工作**：
- 3月5-15日：小范围测试（10-20人）
- 3月15-25日：根据反馈优化
- 3月25日：培训主办方推广方法
- 3月28日：正式在千人会议使用

**验证指标**：
- 匹配成功率 > 30%
- 系统稳定性（无崩溃）
- 用户反馈收集

### 里程碑3：2026年5月1日（73天后）
**目标**：30人游学团使用 + B端基础功能
**新增功能**：
- [ ] B端基础后台（免费）
- [ ] 创建活动 + 生成口令
- [ ] 查看实时匹配进度
- [ ] 导出分房表（Excel）
- [ ] 导出参会者名单

**使用场景**：赵嵩自己的游学团分房

### 里程碑4：2026年6月30日（上半年结束）
**目标**：打赏功能上线，完整运营
**新增功能**：
- [ ] 打赏/服务费支付（微信支付）
- [ ] 用户协议完善
- [ ] 数据统计后台

**目标**：可以服务中国国内任何会议

### 里程碑5：2027年1月（CES展）
**目标**：国际版上线
**新增功能**：
- [ ] 英文版界面
- [ ] 国际化适配（时区、货币等）
- [ ] 可选打赏功能

**目标**：让全世界的人都可以用来拼房

## 商业模式（已确定）

### 核心定位
**不是**：C端省钱工具
**而是**：B端会议方的运营工具 + C端自助拼房平台

### 收入来源（按优先级）

#### 1. C端服务费（主要收入）
**免费阶段**（2026年上半年）：
- 打赏机制，验证付费意愿
- 积累用户和口碑

**收费阶段**（酒店打通后）：
- 从C端支付的房费中收取5-10%服务费
- 用户实际省钱，付费意愿强
- **这是长期主要收入来源**

#### 2. B端订阅费（附加收入）
**免费功能**（流量入口）：
- 创建活动 + 生成口令
- 查看实时匹配进度
- 导出基础分房表

**付费功能**（可选，299元/场 或 2999元/年）：
- 详细习惯报告
- 历史数据管理
- 批量操作
- 定制化导出

**目的**：为重度使用的B端提供增值服务

#### 3. 酒店合作（远期）
- 暂不优先（酒店动力不足）
- 未来可能性：连锁酒店的会员增长需求

### B端合作的两种模式

#### 模式1：推广渠道型（不收费）
**场景**：会议主办方不负责参会者住宿
**B端动作**：推荐工具给参会者
**B端收益**：
- 提高报名率（住宿便宜了）
- 提升服务体验
**我们收益**：获得C端用户
**策略**：免费提供基础功能

#### 模式2：运营工具型（基础免费+高级付费）
**场景**：游学团、培训班（B端包住宿）
**B端需求**：快速分房、导出数据
**B端收益**：
- 节省分房时间（从2小时 → 10分钟）
- 减少投诉
- 提升参与者体验
**我们收益**：
- 流量入口（C端了解工具）
- 可选的订阅收入
**策略**：基础功能免费，高级功能付费

### 流量闭环

```
B端活动 → C端使用（免费/打赏）→ C端认可工具
    ↓
C端自己参加其他会议 → 继续使用 → 付服务费（主要收入）
    ↓
推荐给朋友 → 更多C端用户
```

### 关键数据指标

**C端指标**：
- 匹配成功率 > 30%
- 打赏转化率 > 10%（验证付费意愿）
- 复购率 > 40%（参加多个会议都用）

**B端指标**：
- 会议方推广转化率 > 20%（B端推荐后，C端使用率）
- B端复用率 > 60%（办多次活动都用）
- 付费转化率 > 5%（免费用户升级付费）

## 核心功能设计（已确定）

### 匹配维度
**保持简单，确保匹配成功率**：
- 性别（必须相同）
- 吸烟习惯（必须相同）
- 入住/退房时间（**完全一致**，第一版不做部分重叠）
- 作息倾向（早睡鸟/夜猫子，必须相同）
- 抗噪等级 + 出声分贝（兼容性检查）

**不纳入匹配条件**：
- 预算范围（默认AA制，用户自行协商）
- 床型偏好（默认双床房）
- 其他生活习惯（洗澡时间、空调温度等）

**设计理念**：产品只负责找到条件匹配的人，社交层面的协商由用户自己处理

### 安全机制

**第一版（网页版）**：
- 群口令验证
- 用户协议勾选："我承诺提供的信息真实，并对拼房行为负责。如有纠纷，愿意配合调查。"

**小程序版**：
- 微信登录（免费，天然防刷）
- 一个微信号只能提交一次（覆盖之前的数据）
- 用户协议勾选

**不采用的方案**：
- 手机号验证（需要费用，小程序版用微信登录更好）
- 邮箱验证（用户体验差）

### 匹配成功流程

**双向通知机制**：
1. 后来的人提交表单后，立即看到对方微信号
2. 先来的人：
   - 网页版：刷新页面时看到"你有新的匹配！"并显示对方微信
   - 小程序版：收到微信模板消息通知（免费功能）
3. 双方都标记为"matched"状态，不再出现在池子里

**前提条款**：
- 用户提交表单即同意：能和你匹配上的人可以加你微信

**如果加了微信后不合适**：
- 用户自行拒绝，重新填表
- 系统会覆盖之前的数据，重新入池
- 可能再次匹配到同一个人（第一版接受这个问题，用户需要学会拒绝）

### 未匹配处理

**第一版逻辑**：
- 显示："⏳ 已入池。若有需求匹配的群友，会联系你。若 24 小时无人联系，请微调习惯再次尝试匹配。"
- 用户自己决定调整哪些条件
- 显示此应用上线以来共匹配成功的人数，以鼓励人们使用
- 显示本口令池待匹配的人数，但不显示其他详情，以鼓励人们使用

**不做的功能**（第一版）：
- 不推荐"接近匹配"的人
- 不提示具体调整建议

**设计理念**：
- 时间可以协商调整（用户自己缩短入住时间）
- 睡眠习惯不能妥协（防止有人隐藏真实情况）

### 数据记录

**用户数据结构**：
```json
{
  "wechat_id": "zhangsan",
  "current": {
    "name": "张三",
    "gender": "男",
    "check_in": "2026-02-19",
    "check_out": "2026-02-21",
    "smoking": "否",
    "schedule": "late",
    "noise_in": "normal",
    "noise_out": "mix",
    "group_code": "abc123",
    "status": "active",
    "created_at": 1708099200
  },
  "history": [
    {
      "check_in": "2026-02-18",
      "check_out": "2026-02-20",
      "submitted_at": 1708012800,
      ...
    }
  ],
  "submit_count": 2
}
```

**记录规则**：
- 新提交覆盖 `current` 数据
- 旧数据保存到 `history` 数组
- `submit_count` 递增
- 用户看不到提交次数，但系统内部保留记录

## 技术债务

1. **CSS样式问题**：按钮和单选框的蓝色样式未生效，需要找到Streamlit的正确覆盖方式
2. **服务器部署**：需要部署到腾讯云服务器（已有服务器：49.233.127.228）
3. **数据持久化**：当前用JSON文件，未来可能需要数据库

## 文件结构

```
Roomie Claude/
├── app.py                 # 主程序（Streamlit网页版）
├── room_data.json         # 数据存储文件
├── 数据结构说明.md        # 数据结构详细说明
├── README.md              # 使用说明
└── 项目记录.md            # 本文件
```

## 重要决策记录

### 2026-02-16
- 决定从头重做，解决value值不一致问题
- 选择Streamlit作为网页版框架（快速开发）
- 统一所有字段名和value值

### 2026-02-17（上午）
- 项目命名：Space One拼房实验室（Roomie Claude）
- 确定产品路线图和商业化策略
- 明确核心价值：睡眠质量不打折前提下省钱

### 2026-02-17（下午）
- **确定匹配维度**：保持简单，不加入预算、床型等复杂条件
- **确定安全机制**：网页版用群口令，小程序版用微信登录
- **确定匹配流程**：双向通知，先来的人刷新页面或收到模板消息
- **确定未匹配处理**：第一版只提示24小时后调整，显示统计数据鼓励使用
- **确定数据结构**：保存提交历史，新提交覆盖当前数据
- **明确开发重点**：网页版是原型，快速转向小程序开发
- **确定商业模式**：C端服务费为主要收入，B端分两种合作模式
- **明确产品定位**：不是单纯的C端工具，而是B端运营工具+C端自助平台
- **确定所有时间节点**：
  - 3月5日：小程序基础版上线
  - 3月28日：千人会议实战
  - 5月1日：30人游学团+B端功能
  - 6月30日：打赏功能上线
  - 2027年1月：CES国际版
- **明确资源状态**：
  - 腾讯云服务器可用
  - 小程序审核中（春节期间）
  - 未来5天可实时反馈，上班后中午晚上反馈

## 下次对话提醒

### 紧急任务（3月5日前必须完成）
1. 等待小程序审核通过（预计2月24日）
2. 立即开始小程序前端开发
3. 开发后端API接口
4. 部署到腾讯云服务器
5. 联调测试

### 待解决问题
1. CSS样式问题（按钮和单选框颜色）- 优先级降低，先做小程序
2. 网页版可以暂时搁置，专注小程序开发

### 协作方式
- **未来5天**（2月17-21日）：实时反馈
- **上班后**（2月24日起）：中午和晚上反馈
- **沟通频率**：每天至少一次，遇到问题随时沟通

### 技术准备
- ✅ 腾讯云服务器：49.233.127.228（可用）
- 🔄 微信小程序：审核中
- ✅ 开发环境：本地已搭建

---

**最后更新**：2026-02-17
**当前状态**：网页版原型完成，等待小程序审核，准备进入紧急开发阶段
**紧急程度**：⚠️ 高度紧急 - 距离3月5日只有16天
